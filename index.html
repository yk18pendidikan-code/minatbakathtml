<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Tes Minat Bakat RIASEC</title>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

<style>
:root{
  --bg:#f4f6fb;
  --card:#fff;
  --text:#222;
}

*{box-sizing:border-box}

body{
  font-family:Segoe UI,Arial,sans-serif;
  background:var(--bg);
  margin:0;
  color:var(--text);
}

.container{
  max-width:900px;
  margin:auto;
  padding:20px;
}

.card{
  background:var(--card);
  border-radius:14px;
  padding:20px;
  margin-bottom:18px;
  box-shadow:0 4px 12px rgba(0,0,0,.06);
  page-break-inside:avoid;
}

.center{text-align:center}

.logo-wrap{text-align:center;margin-bottom:12px}
.logo-wrap img{max-width:140px}

button{
  background:#2b4eff;
  color:#fff;
  border:none;
  padding:12px;
  border-radius:10px;
  cursor:pointer;
  width:100%;
  font-size:15px;
}

.print-btn{background:#00a86b}

.section-title{
  font-weight:700;
  font-size:18px;
  margin-bottom:10px;
}

.question{
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:10px;
  margin:12px 0;
}

.scale{display:flex;gap:10px}

.scale input{
  appearance:none;
  width:22px;
  height:22px;
  border-radius:50%;
  border:2px solid #aaa;
  cursor:pointer;
}

.scale input[value="1"]{border-color:#ff4d4d}
.scale input[value="2"]{border-color:#ff944d}
.scale input[value="3"]{border-color:#999}
.scale input[value="4"]{border-color:#4da6ff}
.scale input[value="5"]{border-color:#2b4eff}

.scale input:checked{background:currentColor}
.scale input[value="1"]:checked{color:#ff4d4d}
.scale input[value="2"]:checked{color:#ff944d}
.scale input[value="3"]:checked{color:#999}
.scale input[value="4"]:checked{color:#4da6ff}
.scale input[value="5"]:checked{color:#2b4eff}

/* ===== HASIL & PDF ===== */

.hasil-wrapper{
  display:flex;
  flex-direction:column;
  align-items:center;
}

#pdfArea{
  width:210mm;
  min-height:297mm;
  padding:10mm;
  background:#fff;
}

canvas{
  max-width:180mm;
  margin:20px auto;
  display:block;
}

.btn-row{
  display:flex;
  gap:12px;
  justify-content:center;
  margin-top:20px;
}

.hasil-btn{
  width:210mm;
}

@media(max-width:700px){
  .question{flex-direction:column;align-items:flex-start}
  .hasil-btn{width:100%}
}
</style>
</head>

<body>

<!-- ===== HALAMAN TES ===== -->
<div class="container" id="halamanTes">
  <div class="logo-wrap"><img src="logo2.png"></div>
  <h1 class="center">Tes Minat & Bakat RIASEC</h1>

  <div id="quiz"></div>

  <div class="card center">
    <button onclick="hitung()">Lihat Hasil</button>
  </div>
</div>

<!-- ===== HALAMAN HASIL ===== -->
<div class="container" id="halamanHasil" style="display:none"></div>

<script>
let namaPeserta="Peserta";

/* ===== DATA ===== */
const questions={
R:["Saya suka bekerja menggunakan alat","Saya suka kerja fisik","Saya tertarik memperbaiki barang","Saya suka aktivitas luar","Saya nyaman kerja dengan tangan"],
I:["Saya suka memecahkan masalah","Saya tertarik riset","Saya suka analisis data","Saya berpikir logis","Saya suka sains"],
A:["Saya kreatif","Saya suka seni","Saya tidak suka kerja kaku","Saya suka kebebasan","Saya suka menulis/menggambar"],
S:["Saya suka membantu","Saya suka mengajar","Saya nyaman kerja tim","Saya empatik","Saya komunikatif"],
E:["Saya suka memimpin","Saya percaya diri","Saya tertarik bisnis","Saya suka target","Saya persuasif"],
C:["Saya rapi","Saya teliti","Saya suka administrasi","Saya patuh aturan","Saya suka kerja terstruktur"]
};

const detail={
R:{nama:"Realistic",desc:"Praktis dan teknis",jur:["Teknik Mesin","Teknik Sipil","Otomotif"]},
I:{nama:"Investigative",desc:"Analitis dan ilmiah",jur:["Kedokteran","Biologi","Informatika"]},
A:{nama:"Artistic",desc:"Kreatif dan ekspresif",jur:["DKV","Seni Rupa","Musik"]},
S:{nama:"Social",desc:"Membantu dan komunikatif",jur:["Pendidikan","Psikologi","Keperawatan"]},
E:{nama:"Enterprising",desc:"Kepemimpinan dan bisnis",jur:["Manajemen","Bisnis","Hukum"]},
C:{nama:"Conventional",desc:"Terstruktur dan administratif",jur:["Akuntansi","Administrasi","Perbankan"]}
};

/* ===== RENDER ===== */
const quiz=document.getElementById("quiz");
for(let k in questions){
  let card=document.createElement("div");
  card.className="card";
  card.innerHTML=`<div class="section-title">${k} - ${detail[k].nama}</div>`;
  questions[k].forEach((q,i)=>{
    card.innerHTML+=`
    <div class="question">
      <span>${q}</span>
      <div class="scale">
        ${[1,2,3,4,5].map(v=>`
          <input type="radio" name="${k}_${i}" value="${v}" ${v==3?"checked":""}>
        `).join("")}
      </div>
    </div>`;
  });
  quiz.appendChild(card);
}

/* ===== HITUNG ===== */
function hitung(){
  let skor={};
  for(let k in questions){
    skor[k]=0;
    questions[k].forEach((_,i)=>{
      skor[k]+=+document.querySelector(`input[name="${k}_${i}"]:checked`).value;
    });
  }

  let urut=Object.entries(skor).sort((a,b)=>b[1]-a[1]);

  halamanTes.style.display="none";
  halamanHasil.style.display="block";

  halamanHasil.innerHTML=`
  <div class="hasil-wrapper">
    <div id="pdfArea">
      <div class="logo-wrap"><img src="logo2.png"></div>
      <h1 class="center">Hasil Tes RIASEC</h1>
      <canvas id="chart"></canvas>

      ${urut.slice(0,3).map(u=>`
      <div class="card">
        <h3>${u[0]} - ${detail[u[0]].nama}</h3>
        <p>${detail[u[0]].desc}</p>
        <b>Rekomendasi Jurusan:</b>
        <ul>${detail[u[0]].jur.map(j=>`<li>${j}</li>`).join("")}</ul>
      </div>`).join("")}
    </div>

    <div class="btn-row hasil-btn">
      <button class="print-btn" onclick="window.print()">ðŸ–¨ Cetak</button>
      <button onclick="downloadPDF()">ðŸ“„ Download PDF</button>
    </div>
  </div>`;

  new Chart(chart,{
    type:"radar",
    data:{
      labels:Object.keys(skor),
      datasets:[{
        data:Object.values(skor),
        backgroundColor:"rgba(43,78,255,.2)",
        borderColor:"#2b4eff"
      }]
    },
    options:{scales:{r:{beginAtZero:true}}}
  });
}

/* ===== PDF ===== */
function downloadPDF(){
  const element=document.getElementById("pdfArea");
  setTimeout(()=>{
    html2pdf().set({
      margin:[10,10,10,10],
      filename:"Hasil_RIASEC_"+namaPeserta+".pdf",
      image:{type:'jpeg',quality:0.98},
      html2canvas:{scale:2,scrollY:0,useCORS:true},
      jsPDF:{unit:'mm',format:'a4',orientation:'portrait'},
      pagebreak:{mode:['css','legacy']}
    }).from(element).save();
  },500);
}
</script>

</body>
</html>
