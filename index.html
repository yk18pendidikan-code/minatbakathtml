<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Tes Minat Bakat RIASEC Neutron Murangan</title>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

<style>
:root{--bg:#f4f6fb;--card:#fff;--text:#222}
*{box-sizing:border-box}

body{
  font-family:Segoe UI,Arial,sans-serif;
  background:var(--bg);
  margin:0;color:var(--text)
}
.container{max-width:900px;margin:auto;padding:20px}
.card{
  background:var(--card);
  border-radius:14px;
  padding:20px;
  margin-bottom:18px;
  box-shadow:0 4px 12px rgba(0,0,0,.06);
  page-break-inside:avoid;
}
.center{text-align:center}
.logo-wrap{text-align:center;margin-bottom:12px}
.logo-wrap img{max-width:140px}

input[type=text]{
  width:100%;padding:12px;border-radius:10px;
  border:1px solid #ccc;margin:8px 0 16px;font-size:15px
}
button{
  background:#2b4eff;color:#fff;border:none;
  padding:12px;border-radius:10px;cursor:pointer;width:100%
}
.print-btn{background:#00a86b}

.question{
  display:flex;justify-content:space-between;
  gap:10px;margin:12px 0
}
.scale{display:flex;gap:10px}
.scale input{
  appearance:none;width:22px;height:22px;
  border-radius:50%;border:2px solid #aaa;cursor:pointer
}
.scale input[value="1"]{border-color:#ff4d4d}
.scale input[value="2"]{border-color:#ff944d}
.scale input[value="3"]{border-color:#999}
.scale input[value="4"]{border-color:#4da6ff}
.scale input[value="5"]{border-color:#2b4eff}
.scale input:checked{background:currentColor}
.scale input[value="1"]:checked{color:#ff4d4d}
.scale input[value="2"]:checked{color:#ff944d}
.scale input[value="3"]:checked{color:#999}
.scale input[value="4"]:checked{color:#4da6ff}
.scale input[value="5"]:checked{color:#2b4eff}

/* ===== HASIL ===== */
.hasil-wrapper{display:flex;flex-direction:column;align-items:center}
#pdfArea{
  width:100%;max-width:210mm;
  background:#fff;padding:20px
}
canvas{max-width:100%;margin:20px auto;display:block}
.btn-row{display:flex;gap:12px;justify-content:center;flex-wrap:wrap;margin:20px}

@media(max-width:700px){
  .question{flex-direction:column}
}
</style>
</head>

<body>

<!-- ===== AKSES ===== -->
<div class="container" id="halamanAkses">
  <div class="card center">
    <div class="logo-wrap"><img src="logo2.png"></div>
    <h2>Akses Tes RIASEC Neutron Murangan</h2>
    <input type="text" id="namaInput" placeholder="Nama Peserta">
    <input type="text" id="kodeInput" placeholder="Kode Akses">
    <button onclick="cekAkses()">Masuk Tes</button>
  </div>
</div>

<!-- ===== TES ===== -->
<div class="container" id="halamanTes" style="display:none">
  <div class="logo-wrap"><img src="logo2.png"></div>
  <h2 class="center">Tes Minat & Bakat RIASEC</h2>
  <p class="center"><b>Nama:</b> <span id="namaView"></span></p>

  <div class="card">
    <b>Keterangan Skala:</b>
    <ul>
      <li>1 = Sangat Tidak Sesuai</li>
      <li>2 = Tidak Sesuai</li>
      <li>3 = Netral</li>
      <li>4 = Sesuai</li>
      <li>5 = Sangat Sesuai</li>
    </ul>
  </div>

  <div id="quiz"></div>

  <div class="card center">
    <button onclick="hitung()">Lihat Hasil</button>
  </div>
</div>

<!-- ===== HASIL ===== -->
<div class="container" id="halamanHasil" style="display:none"></div>

<script>
let namaPeserta="Peserta";
const kodeBenar="neutronmurangan";

function cekAkses(){
  if(namaInput.value===""){alert("Nama wajib diisi");return}
  if(kodeInput.value!==kodeBenar){alert("Kode salah");return}
  namaPeserta=namaInput.value;
  namaView.innerText=namaPeserta;
  halamanAkses.style.display="none";
  halamanTes.style.display="block";
}

/* ===== DATA ===== */
const questions={R:["Saya senang bekerja menggunakan alat, mesin, atau peralatan teknis","Saya lebih suka pekerjaan fisik","Saya tertarik memperbaiki benda","Saya menikmati pekerjaan lapangan","Saya puas melihat hasil nyata","Saya suka praktik langsung","Saya tertarik dunia teknik","Saya nyaman bekerja dengan benda"],
I:["Saya suka memecahkan masalah","Saya tertarik penelitian","Saya suka analisis data","Saya ingin tahu sebab akibat","Saya berpikir logis","Saya suka sains","Saya suka membaca ilmiah","Saya suka bekerja mandiri"],
A:["Saya kreatif","Saya imajinatif","Saya tidak suka aturan kaku","Saya suka kebebasan","Saya tertarik seni","Saya suka hal unik","Saya nyaman tanpa pola","Saya lebih suka ide"],
S:["Saya suka membantu","Saya komunikatif","Saya suka mengajar","Saya empatik","Saya suka tim","Saya ingin bermanfaat","Saya tertarik sosial","Saya pendengar baik"],
E:["Saya percaya diri","Saya suka memimpin","Saya tertarik bisnis","Saya suka target","Saya persuasif","Saya berani ambil keputusan","Saya aktif organisasi","Saya suka kompetisi"],
C:["Saya rapi","Saya teliti","Saya patuh aturan","Saya suka data","Saya suka administrasi","Saya terencana","Saya tahan tugas rutin","Saya suka struktur"]};

const detail={
R:{nama:"Realistic",desc:"Praktis dan teknis",jur:["Teknik Mesin","Teknik Sipil","Teknik Elektro"]},
I:{nama:"Investigative",desc:"Analitis dan ilmiah",jur:["Kedokteran","Farmasi","Informatika"]},
A:{nama:"Artistic",desc:"Kreatif dan ekspresif",jur:["DKV","Film","Sastra"]},
S:{nama:"Social",desc:"Suka membantu",jur:["Psikologi","Keperawatan","PGSD"]},
E:{nama:"Enterprising",desc:"Kepemimpinan",jur:["Manajemen","Bisnis","Hukum"]},
C:{nama:"Conventional",desc:"Terstruktur",jur:["Akuntansi","Administrasi","Perbankan"]}
};

/* ===== RENDER ===== */
for(let k in questions){
  let c=document.createElement("div");
  c.className="card";
  c.innerHTML=`<b>${k} - ${detail[k].nama}</b>`;
  questions[k].forEach((q,i)=>{
    c.innerHTML+=`
    <div class="question">
      <span>${q}</span>
      <div class="scale">
        ${[1,2,3,4,5].map(v=>`<input type="radio" name="${k}_${i}" value="${v}" ${v==3?"checked":""}>`).join("")}
      </div>
    </div>`;
  });
  quiz.appendChild(c);
}

/* ===== HITUNG ===== */
function hitung(){
  let skor={};
  for(let k in questions){
    skor[k]=0;
    questions[k].forEach((_,i)=>{
      skor[k]+=+document.querySelector(`input[name="${k}_${i}"]:checked`).value;
    });
  }

  let urut=Object.entries(skor).sort((a,b)=>b[1]-a[1]);

  halamanTes.style.display="none";
  halamanHasil.style.display="block";

  halamanHasil.innerHTML=`
  <div class="hasil-wrapper">
    <div id="pdfArea">
      <div class="logo-wrap"><img src="logo2.png"></div>
      <h2 class="center">Hasil Tes RIASEC</h2>
      <p class="center"><b>Nama:</b> ${namaPeserta}</p>
      <canvas id="chart"></canvas>
      ${urut.slice(0,3).map(u=>`
        <div class="card">
          <b>${u[0]} - ${detail[u[0]].nama}</b>
          <p>${detail[u[0]].desc}</p>
          <ul>${detail[u[0]].jur.map(j=>`<li>${j}</li>`).join("")}</ul>
        </div>`).join("")}
    </div>

    <div class="btn-row">
      <button class="print-btn" onclick="window.print()">ðŸ–¨ Cetak</button>
      <button onclick="downloadPDF()">ðŸ“„ Download PDF</button>
    </div>
  </div>`;

  setTimeout(()=>{
    new Chart(chart,{
      type:"radar",
      data:{labels:Object.keys(skor),datasets:[{data:Object.values(skor),backgroundColor:"rgba(43,78,255,.2)",borderColor:"#2b4eff"}]},
      options:{responsive:true,scales:{r:{beginAtZero:true}}}
    });
  },200);
}

/* ===== PDF FIX (KODE ANDA) ===== */
function downloadPDF(){
  var element=document.getElementById("pdfArea");

  setTimeout(()=>{
    html2pdf().set({
      margin:[10,10,10,10],
      filename:"Hasil_RIASEC_"+namaPeserta+".pdf",
      image:{type:'jpeg',quality:0.98},
      html2canvas:{scale:2,scrollY:0,useCORS:true},
      jsPDF:{unit:'mm',format:'a4',orientation:'portrait'},
      pagebreak:{mode:['css','legacy']}
    }).from(element).save();
  },500);
}
</script>

</body>
</html>
